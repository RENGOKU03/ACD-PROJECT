<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="output.css">
</head>

<body class="">
    <label>Name</label> <input id="Namebox" type="text">
    <label>Image</label> <input id="Imagebox" type="text">
    <label>Make</label> <input id="Makebox" type="text">
    <label>Price</label> <input id="Pricebox" type="text">
    <label>Rating</label> <input id="Ratingbox" type="text">
    <label>Categories </label>
    <select id="Categorybox">
        <option value="Mobile">Mobile</option>
        <option value="Books">Books</option>
        <option value="Electronics">Electronics</option>
        <option value="Home">Home</option>
        <option value="Fashion">Fashion</option>
    </select>

    <button class="bg-black text-white" id="Insbtn">INSERT</button>
    <button id="Selbtn">SELECT</button>
    <button id="Updbtn">UPDATE</button>
    <button id="Delbtn">DELETE</button>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyCSOsAdb5KlBTWg8OaI-kb3Np_apubBzBs",
            authDomain: "clone-7e368.firebaseapp.com",
            databaseURL: "https://clone-7e368-default-rtdb.firebaseio.com",
            projectId: "clone-7e368",
            storageBucket: "clone-7e368.appspot.com",
            messagingSenderId: "156834042204",
            appId: "1:156834042204:web:4717c05711d9747a88b199",
            measurementId: "G-VF48NF5E0E"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        import {
            getFirestore, doc, getDoc, setDoc, collection, addDoc, updateDoc, deleteDoc, deleteField
        }
            from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const db = getFirestore();


        let NameBox = document.getElementById("Namebox");
        let MakeBox = document.getElementById("Makebox");
        let PriceBox = document.getElementById("Pricebox");
        let RatingBox = document.getElementById("Ratingbox");
        let ImageBox = document.getElementById("Imagebox");
        let CategoryBox = document.getElementById("Categorybox");


        let insBtn = document.getElementById("Insbtn")
        let selBtn = document.getElementById("Selbtn")
        let updBtn = document.getElementById("Updbtn")
        let delBtn = document.getElementById("Delbtn")

        // Adding Document

        async function AddDocument_CustomID() {
            var ref = doc(db, "items2", CategoryBox.value);

            await setDoc(
                ref, {
                Name: NameBox.value,
                Make: MakeBox.value,
                Image: ImageBox.value,
                Price: PriceBox.value,
                Rating: RatingBox.value,
                Category: CategoryBox.value
            }
            )
                .then(() => {
                    alert("Data Added Successfully");
                })
                .catch((error) => {
                    alert("Unsuccessful" + error);
                });
        }


        // Select Event
        async function GetADocument() {
            var ref = doc(db, "items2", CategoryBox.value);
            const docSnap = await getDoc(ref);

            if (docSnap.exists()) {
                NameBox.value = docSnap.data().Name;
                MakeBox.value = docSnap.data().Make;
                ImageBox.value = docSnap.data().Image;
                RatingBox.value = docSnap.data().Rating;
                PriceBox.value = docSnap.data().Price;
            }

            else {
                alert("No Such Document");
            }
        }

        // Update Data
        async function UpdateDocumentsFiled() {
            var ref = doc(db, "items2", CategoryBox.value);

            await updateDoc(
                ref, {
                Name: NameBox.value,
                Make: MakeBox.value,
                Image: ImageBox.value,
                Price: PriceBox.value,
                Rating: RatingBox.value,

            }
            )
                .then(() => {
                    alert("Data Updated Successfully");
                })
                .catch((error) => {
                    alert("Unsuccessful" + error);
                });
        }


        // Deleting a Document 
        // async function DeleteDocument() {
        //     var ref = doc(db, "items2", CategoryBox.value);
        //     const docSnap = await getDoc(ref);

        //     if (!docSnap.exists()) {
        //         alert("Document Does not Exist");
        //         return;
        //     }

        //     await deleteDoc(ref)
        //         .then(() => {
        //             alert("Data Updated Successfully");
        //         })
        //         .catch((error) => {
        //             alert("Unsuccessful" + error);
        //         });
        // }


        // Assign Buttons to Events

        insBtn.addEventListener("click", AddDocument_CustomID);
        selBtn.addEventListener("click", GetADocument);
        updBtn.addEventListener("click", UpdateDocumentsFiled);
        // delBtn.addEventListener("click", DeleteDocument);
    </script>
</body>

</html>